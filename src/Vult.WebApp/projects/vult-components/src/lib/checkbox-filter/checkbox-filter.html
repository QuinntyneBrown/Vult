<div class="checkbox-filter" role="group" [attr.aria-labelledby]="labelId">
  @if (label) {
    <button
      type="button"
      class="checkbox-filter__header"
      [id]="labelId"
      (click)="toggleExpanded()"
      [attr.aria-expanded]="expanded()"
      [attr.aria-controls]="contentId"
    >
      <span class="checkbox-filter__label">{{ label }}</span>
      <mat-icon class="checkbox-filter__chevron" [class.checkbox-filter__chevron--rotated]="expanded()">
        expand_more
      </mat-icon>
    </button>
  }

  <div
    [id]="contentId"
    class="checkbox-filter__content"
    [class.checkbox-filter__content--collapsed]="!expanded()"
  >
    @for (option of options; track option.id) {
      <mat-checkbox
        class="checkbox-filter__option"
        [checked]="isChecked(option.id)"
        [disabled]="disabled()"
        (change)="onOptionChange(option, $event.checked)"
      >
        <span class="checkbox-filter__text">{{ option.label }}</span>
        @if (option.count !== undefined) {
          <span class="checkbox-filter__count">({{ option.count }})</span>
        }
      </mat-checkbox>
    }
  </div>
</div>
